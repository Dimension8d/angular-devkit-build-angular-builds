"use strict";
/**
 * @license
 * Copyright Google Inc. All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
Object.defineProperty(exports, "__esModule", { value: true });
const core_1 = require("@angular-devkit/core");
const normalize_file_replacements_1 = require("./normalize-file-replacements");
const normalize_optimization_1 = require("./normalize-optimization");
const normalize_source_maps_1 = require("./normalize-source-maps");
function normalizeWebpackServerSchema(host, root, projectRoot, sourceRoot, options) {
    const syncHost = new core_1.virtualFs.SyncDelegateHost(host);
    const normalizedSourceMapOptions = normalize_source_maps_1.normalizeSourceMaps(options.sourceMap || {});
    normalizedSourceMapOptions.vendor =
        normalizedSourceMapOptions.vendor || options.vendorSourceMap || false;
    const optimization = options.hasOwnProperty('optimization') && options.optimization || {};
    return Object.assign({}, options, { fileReplacements: normalize_file_replacements_1.normalizeFileReplacements(options.fileReplacements || [], syncHost, root), optimization: normalize_optimization_1.normalizeOptimization(optimization), sourceMap: normalizedSourceMapOptions });
}
exports.normalizeWebpackServerSchema = normalizeWebpackServerSchema;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9ybWFsaXplLXdlYnBhY2stc2VydmVyLXNjaGVtYS5qcyIsInNvdXJjZVJvb3QiOiIuLyIsInNvdXJjZXMiOlsicGFja2FnZXMvYW5ndWxhcl9kZXZraXQvYnVpbGRfYW5ndWxhci9zcmMvdXRpbHMvbm9ybWFsaXplLXdlYnBhY2stc2VydmVyLXNjaGVtYS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQ0E7Ozs7OztHQU1HOztBQUdILCtDQUF1RDtBQUd2RCwrRUFHdUM7QUFDdkMscUVBQWlFO0FBQ2pFLG1FQUE4RDtBQVc5RCxTQUFnQiw0QkFBNEIsQ0FDMUMsSUFBd0IsRUFDeEIsSUFBVSxFQUNWLFdBQWlCLEVBQ2pCLFVBQTRCLEVBQzVCLE9BQWlDO0lBRWpDLE1BQU0sUUFBUSxHQUFHLElBQUksZ0JBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUV0RCxNQUFNLDBCQUEwQixHQUFHLDJDQUFtQixDQUFDLE9BQU8sQ0FBQyxTQUFTLElBQUksRUFBRSxDQUFDLENBQUM7SUFDaEYsMEJBQTBCLENBQUMsTUFBTTtRQUMvQiwwQkFBMEIsQ0FBQyxNQUFNLElBQUksT0FBTyxDQUFDLGVBQWUsSUFBSSxLQUFLLENBQUM7SUFFeEUsTUFBTSxZQUFZLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQyxjQUFjLENBQUMsSUFBSSxPQUFPLENBQUMsWUFBWSxJQUFJLEVBQUUsQ0FBQztJQUUxRix5QkFDSyxPQUFPLElBQ1YsZ0JBQWdCLEVBQUUsdURBQXlCLENBQUMsT0FBTyxDQUFDLGdCQUFnQixJQUFJLEVBQUUsRUFBRSxRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQzNGLFlBQVksRUFBRSw4Q0FBcUIsQ0FBQyxZQUFZLENBQUMsRUFDakQsU0FBUyxFQUFFLDBCQUEwQixJQUNyQztBQUNKLENBQUM7QUFyQkQsb0VBcUJDIiwic291cmNlc0NvbnRlbnQiOlsiXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgR29vZ2xlIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhbiBNSVQtc3R5bGUgbGljZW5zZSB0aGF0IGNhbiBiZVxuICogZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBhdCBodHRwczovL2FuZ3VsYXIuaW8vbGljZW5zZVxuICovXG5cblxuaW1wb3J0IHsgUGF0aCwgdmlydHVhbEZzIH0gZnJvbSAnQGFuZ3VsYXItZGV2a2l0L2NvcmUnO1xuaW1wb3J0IHsgT3B0aW1pemF0aW9uQ2xhc3MsIFNvdXJjZU1hcENsYXNzIH0gZnJvbSAnLi4vYnJvd3Nlci9zY2hlbWEnO1xuaW1wb3J0IHsgU2NoZW1hIGFzIEJ1aWxkV2VicGFja1NlcnZlclNjaGVtYSB9IGZyb20gJy4uL3NlcnZlci9zY2hlbWEnO1xuaW1wb3J0IHtcbiAgTm9ybWFsaXplZEZpbGVSZXBsYWNlbWVudCxcbiAgbm9ybWFsaXplRmlsZVJlcGxhY2VtZW50cyxcbn0gZnJvbSAnLi9ub3JtYWxpemUtZmlsZS1yZXBsYWNlbWVudHMnO1xuaW1wb3J0IHsgbm9ybWFsaXplT3B0aW1pemF0aW9uIH0gZnJvbSAnLi9ub3JtYWxpemUtb3B0aW1pemF0aW9uJztcbmltcG9ydCB7IG5vcm1hbGl6ZVNvdXJjZU1hcHMgfSBmcm9tICcuL25vcm1hbGl6ZS1zb3VyY2UtbWFwcyc7XG5cbi8qKlxuICogQSBub3JtYWxpemVkIHdlYnBhY2sgc2VydmVyIGJ1aWxkZXIgc2NoZW1hLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIE5vcm1hbGl6ZWRXZWJwYWNrU2VydmVyQnVpbGRlclNjaGVtYSBleHRlbmRzIEJ1aWxkV2VicGFja1NlcnZlclNjaGVtYSB7XG4gIHNvdXJjZU1hcDogU291cmNlTWFwQ2xhc3M7XG4gIGZpbGVSZXBsYWNlbWVudHM6IE5vcm1hbGl6ZWRGaWxlUmVwbGFjZW1lbnRbXTtcbiAgb3B0aW1pemF0aW9uOiBPcHRpbWl6YXRpb25DbGFzcztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZVdlYnBhY2tTZXJ2ZXJTY2hlbWEoXG4gIGhvc3Q6IHZpcnR1YWxGcy5Ib3N0PHt9PixcbiAgcm9vdDogUGF0aCxcbiAgcHJvamVjdFJvb3Q6IFBhdGgsXG4gIHNvdXJjZVJvb3Q6IFBhdGggfCB1bmRlZmluZWQsXG4gIG9wdGlvbnM6IEJ1aWxkV2VicGFja1NlcnZlclNjaGVtYSxcbik6IE5vcm1hbGl6ZWRXZWJwYWNrU2VydmVyQnVpbGRlclNjaGVtYSB7XG4gIGNvbnN0IHN5bmNIb3N0ID0gbmV3IHZpcnR1YWxGcy5TeW5jRGVsZWdhdGVIb3N0KGhvc3QpO1xuXG4gIGNvbnN0IG5vcm1hbGl6ZWRTb3VyY2VNYXBPcHRpb25zID0gbm9ybWFsaXplU291cmNlTWFwcyhvcHRpb25zLnNvdXJjZU1hcCB8fCB7fSk7XG4gIG5vcm1hbGl6ZWRTb3VyY2VNYXBPcHRpb25zLnZlbmRvciA9XG4gICAgbm9ybWFsaXplZFNvdXJjZU1hcE9wdGlvbnMudmVuZG9yIHx8IG9wdGlvbnMudmVuZG9yU291cmNlTWFwIHx8IGZhbHNlO1xuXG4gIGNvbnN0IG9wdGltaXphdGlvbiA9IG9wdGlvbnMuaGFzT3duUHJvcGVydHkoJ29wdGltaXphdGlvbicpICYmIG9wdGlvbnMub3B0aW1pemF0aW9uIHx8IHt9O1xuXG4gIHJldHVybiB7XG4gICAgLi4ub3B0aW9ucyxcbiAgICBmaWxlUmVwbGFjZW1lbnRzOiBub3JtYWxpemVGaWxlUmVwbGFjZW1lbnRzKG9wdGlvbnMuZmlsZVJlcGxhY2VtZW50cyB8fCBbXSwgc3luY0hvc3QsIHJvb3QpLFxuICAgIG9wdGltaXphdGlvbjogbm9ybWFsaXplT3B0aW1pemF0aW9uKG9wdGltaXphdGlvbiksXG4gICAgc291cmNlTWFwOiBub3JtYWxpemVkU291cmNlTWFwT3B0aW9ucyxcbiAgfTtcbn1cbiJdfQ==